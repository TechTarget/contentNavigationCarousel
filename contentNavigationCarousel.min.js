/*!
 * Content Navigation Carousel v0.5 (http://okize.github.com/)
 * Copyright (c) 2012 | Licensed under the MIT license - http://www.opensource.org/licenses/mit-license.php
 */(function(e,t,n){"use strict";function o(t,n){this.element=t,this.options=e.extend({},s,n),this._defaults=s,this._name=r,this.init()}var r="contentNavigationCarousel",i=t.document,s={autoplay:!0,autoplaySpeed:1e4,mouseEvent:"click",switchSpeed:500,equalizeHeights:!0};o.prototype.init=function(){var t=this.options,n=e(this.element),r=n.find(".contentCollection"),i=0,s=r.find(".contentItem"),o=0,u=0,a=s.find(".contentLink"),f=e('<div class="contentNavigation" />'),l=0,c,h=0,p,d=-1,v=0,m=n.attr("data-autoplay"),g={start:function(){this.timeout=setTimeout(e.proxy(this.next,this),t.autoplaySpeed)},next:function(){v=v===h-1?0:v+1,y(v)},stop:function(){clearTimeout(this.timeout)}},y=function(e){c.eq(e).find("a").trigger(t.mouseEvent)},b=function(n){t.autoplay&&g.stop(),t.mouseEvent==="click"&&n.preventDefault(),p=e(this),v=p.data("index"),c.removeClass("active"),c.eq(v).addClass("active"),v!==d&&(s.eq(d).fadeOut(t.switchSpeed/2,function(){s.eq(v).fadeIn(t.switchSpeed/2)}),d=v),t.autoplay&&g.start()};if(a.length<=1)return;t.mouseEvent==="hover"&&(t.mouseEvent="mouseenter"),c=e.map(a,function(e,t){return h++,'<li><a href="'+e.href+'" data-index="'+t+'">'+(e.textContent||e.innerText)+"</a></li>"}),c=e(c.join("")),f.append(e("<ul>").append(c)).insertAfter(r),l=f.height(),i=Math.max.apply(null,s.map(function(){return e(this).height()}).get()),r.css("overflow")==="hidden"&&r.height(i),t.equalizeHeights&&(l>i?r.height(l):f.height(i)),s.each(function(t){o=e(this).height(),u=Math.round((l-o)/2),e(this).css({display:"none",top:u+"px"})}),m&&(m>0?(t.autoplay=!0,t.autoplaySpeed=m):(t.autoplay=!1,t.autoplaySpeed=0)),c.on(t.mouseEvent,"a",b),t.autoplay&&g.start(),y(v)},e.fn[r]=function(t){return this.each(function(){e.data(this,"plugin_"+r)||e.data(this,"plugin_"+r,new o(this,t))})}})(jQuery,window);